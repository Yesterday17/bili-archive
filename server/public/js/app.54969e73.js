(function(t){function e(e){for(var s,r,o=e[0],d=e[1],c=e[2],l=0,p=[];l<o.length;l++)r=o[l],a[r]&&p.push(a[r][0]),a[r]=0;for(s in d)Object.prototype.hasOwnProperty.call(d,s)&&(t[s]=d[s]);u&&u(e);while(p.length)p.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],s=!0,o=1;o<n.length;o++){var d=n[o];0!==a[d]&&(s=!1)}s&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var s={},a={app:0},i=[];function r(e){if(s[e])return s[e].exports;var n=s[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=s,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(n,s,function(e){return t[e]}.bind(null,s));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=d;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"48c6":function(t,e,n){},"4b31":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var s=n("2b0e"),a=n("43f9"),i=n.n(a),r=(n("51de"),n("e094"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("md-steppers",{attrs:{"md-linear":"","md-sync-route":"","md-dynamic-height":""}},[n("md-step",{staticClass:"center",attrs:{id:"step-00","md-label":"欢迎","md-description":"欢迎使用","md-editable":!0,"md-done":this.step>0,to:"/step-00"}},[n("keep-alive",[0===this.display?n("router-view"):t._e()],1)],1),n("md-step",{staticClass:"center",attrs:{id:"step-01","md-label":"登录","md-description":"扫描二维码","md-editable":!1,"md-done":this.step>1,to:"/step-01"}},[n("keep-alive",[1===this.display?n("router-view"):t._e()],1)],1),n("md-step",{staticClass:"center",attrs:{id:"step-02","md-label":"选择收藏夹","md-description":"需要存档的视频列表","md-editable":!1,"md-done":this.step>2,to:"/step-02"}},[n("keep-alive",[2===this.display?n("router-view"):t._e()],1)],1),n("md-step",{staticClass:"center",attrs:{id:"step-03","md-label":"下载","md-description":"存档视频","md-editable":!1,to:"/step-03"}},[n("keep-alive",[3===this.display?n("router-view"):t._e()],1)],1)],1),n("md-button",{staticClass:"md-fab md-primary",attrs:{id:"step-next",disabled:!this.canGoNext},on:{click:t.next}},[n("md-icon",[t._v("navigate_next")])],1)],1)}),o=[],d=n("e814"),c=n.n(d),u={data:function(){return{display:0,step:0,goNextFlag:!1}},methods:{next:function(){localStorage.getItem("step")&&(this.step=c()(localStorage.getItem("step")),this.display!==this.step?this.$router.push("step-0"+this.step):this.$router.push("step-0"+ ++this.step)),this.display=this.step,localStorage.setItem("step",this.step)}},watch:{$route:function(t,e){var n=this.$route.path;this.display=c()(n.substr(n.length-2,2)),this.goNextFlag=!!this.$route.query.next&&this.$route.query.next}},computed:{canGoNext:function(){return 0===this.display||this.goNextFlag}},created:function(){this.step=localStorage.getItem("step")?c()(localStorage.getItem("step")):0,this.display=this.step,localStorage.setItem("step",this.step),this.$router.push("step-0"+this.step)}},l=u,p=(n("5c0b"),n("2877")),h=Object(p["a"])(l,r,o,!1,null,null,null),m=h.exports,v=n("8c4f"),f=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},_=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("p",[t._v("\n    欢迎使用\n    "),n("code",[t._v("bili-archive")]),t._v(" ！在使用之前，请详细阅读以下指南~\n  ")]),n("h2",{attrs:{id:"前言"}},[t._v("前言")]),n("p",[t._v("\n    一切的起因是某天我去看我\n    "),n("a",{attrs:{href:"https://space.bilibili.com/123817257/favlist?fid=283019357"}},[t._v("百万")]),t._v("收藏夹的时候发现半数以上视频惨遭爆破，后来又去找\n    "),n("a",{attrs:{href:"https://www.biliplus.com/video/av4931739/"}},[t._v("M@STERPIECE")]),t._v("又发现被爆破。看来今后这样的事情会越来越多的吧，不如缓存下来省事。\n  ")]),n("h2",{attrs:{id:"如何使用"}},[t._v("如何使用")]),n("h3",{attrs:{id:"步骤-01---登录"}},[t._v("步骤 01 - 登录")]),n("p",[t._v("\n    看完这页欢迎页面，你就需要进入下一步的登录。登录\n    "),n("strong",[t._v("只支持二维码登录")]),t._v("。\n    "),n("br"),t._v("（因为这是最简单的实现方式了\n    "),n("br"),t._v("（而且也不用让你们担心收集用户名密码什么的（逃\n  ")]),n("p",[t._v("\n    注意在这里建议选择开通了\n    "),n("s",[t._v("带")]),t._v("大会员的账号登录，以下载到最高画质(1080P60)的视频。\n  ")]),n("h3",{attrs:{id:"步骤-02---选择收藏"}},[t._v("步骤 02 - 选择收藏")]),n("p",[t._v("\n    这一步的选择收藏其实是选择需要下载的收藏夹所属用户。比如我现在的运行模式是大号大会员投稿，小号日用\n    "),n("s",[t._v("天天 awsl")]),t._v("，画风不同，不在 Timeline 打扰别人。这时候我想要下载我小号的收藏视频，又想要最高画质（大会员），就需要在这一步输入我小号的\n    "),n("code",[t._v("UID")]),t._v("。相信了解到这个工具的用户不至于连 UID 怎么查都不知道吧，这里就不再赘述了。\n  ")]),n("h3",{attrs:{id:"步骤-03---开始下载"}},[t._v("步骤 03 - 开始下载")]),n("p",[t._v("\n    这一步就是纯粹的等待了，这时候在控制台会显示详细的视频下载状况（调用了\n    "),n("a",{attrs:{href:"https://github.com/iawia002/annie"}},[t._v("annie")]),t._v("），网页端也会有详细的信息显示(\n    "),n("code",[t._v("WIP")]),t._v(")。\n    "),n("br"),t._v("值得注意的是在这一步下载的过程中，如果发现之前有下载过某视频，会自动跳过该视频的下载（以分 P 为准）。因此，你可以把它当作日常备份工具来用。\n    "),n("br"),n("code",[t._v("// 持久化存储cookies (WIP)")])]),n("h2",{attrs:{id:"faq"}},[t._v("FAQ")])])}],g={name:"Welcome",data:function(){return{}}},b=g,y=Object(p["a"])(b,f,_,!1,null,"10120e37",null),w=y.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"center column",attrs:{id:"login"}},[n("div",{staticClass:"center",attrs:{id:"qr-box"}},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[this.timeout?n("div",{staticClass:"center column"},[n("div",[t._v("二维码已超时")]),n("md-button",{staticClass:"md-dense md-raised md-primary",on:{click:t.refresh}},[t._v("点击刷新")])],1):""===this.qrCode?n("div",[t._v("加载登录二维码中……")]):n("img",{attrs:{src:this.qrCode,alt:"qrCode"}})])],1),n("div",[n("div",{class:this.logined?"":"rotate",attrs:{id:"login-icon"}},[this.logined?n("md-icon",[t._v("verified_user'")]):n("md-icon",[t._v("sync")])],1),n("span",[t._v(t._s(this.logined?"登录成功，请点击下一步。":"扫描二维码以登录"))])]),t.logined?t._e():n("div",[n("p",[t._v("登录检查每 3 秒进行一次")]),n("p",[t._v("二维码超时时间为 300 秒")])])])},S=[],C={name:"Login",data:function(){return{timeout:!1,logined:!1,qrCode:"",iStatus:void 0,iTimeout:void 0}},created:function(){this.getQRCode()},methods:{getQRCode:function(){var t=this;fetch("//localhost:8080/login-qr").then(function(t){return t.json()}).then(function(e){return t.qrCode=e.image}).then(function(){t.iStatus=setInterval(function(){fetch("//localhost:8080/login-status").then(function(t){return t.json()}).then(function(e){e.ok&&(clearInterval(t.iStatus),clearInterval(t.iTimeout),t.logined=!0,t.$router.push({path:t.$router.path,query:{next:!0}}))})},3e3),t.iTimeout=setInterval(function(){clearInterval(t.iStatus),clearInterval(t.iTimeout)},3e5)})},refresh:function(){this.qrCode="",this.timeout=!1,this.getQRCode()}}},I=C,k=(n("7b83"),Object(p["a"])(I,x,S,!1,null,"32e24114",null)),$=k.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"select"}},[n("md-card",{attrs:{"md-with-hover":""}},[n("md-ripple",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("下载用户？")]),n("div",{staticClass:"md-subhead"},[t._v("选择是否下载当前登录用户的收藏视频")])]),n("md-card-content",[t.currentUser?n("div",[n("p",[t._v("下载来源为当前用户的收藏夹，即使用本账号下载本账号的收藏夹。")]),n("p",[t._v("如果你想要下载其他用户（比如自己小号）的收藏夹，请取消勾选下方的“当前用户”。")])]):n("div",[n("md-field",{class:t.uidClass},[n("label",[t._v("UID")]),n("md-input",{attrs:{type:"string"},on:{change:t.changeMode},model:{value:t.uid,callback:function(e){t.uid=e},expression:"uid"}}),n("span",{staticClass:"md-error"},[t._v(t._s(this.error))])],1),n("p",[t._v("下载来源为上方UID用户的收藏夹，即使用已登录账号下载上方账号的收藏夹。")]),n("p",[t._v("上方账号需要开放收藏夹可见权限以正确识别收藏夹内容。")]),n("p",[t._v("如果你想要下载当前用户的的收藏夹，请勾选下方的“当前用户”。")])],1)]),n("md-card-actions",["updating"===this.status?n("md-button",{attrs:{disabled:""}},[t._v("更新信息中……")]):t._e(),n("md-checkbox",{staticClass:"md-primary",on:{change:t.changeMode},model:{value:t.currentUser,callback:function(e){t.currentUser=e},expression:"currentUser"}},[t._v("当前用户")])],1)],1)],1),n("md-snackbar",{attrs:{"md-position":"center","md-duration":1/0,"md-active":t.showStatus,"md-persistent":""},on:{"update:mdActive":function(e){t.showStatus=e},"update:md-active":function(e){t.showStatus=e}}},[n("span",[t._v(t._s(this.status))]),n("md-button",{staticClass:"md-primary",on:{click:t.next}},[t._v("确认")])],1)],1)},j=[],O=(n("4917"),n("7f7f"),{name:"SelectFavorite",data:function(){return{currentUser:!1,uid:"",error:"",showStatus:!1,status:"",uname:"",avatar:""}},computed:{uidClass:function(){return{"md-invalid":""!==this.error}}},methods:{clear:function(){this.currentUser=!1,this.uid="",this.error="",this.showStatus=!1,this.status="",this.uname="",this.avatar=""},getUserData:function(){var t=this;return fetch("//localhost:8080/info?uid="+this.uid).then(function(t){return t.json()}).then(function(e){e.ok&&0!==e.data.mid?(t.uname=e.data.name,t.avatar=e.data.face):(alert("用户不存在！"),t.clear())})},changeMode:function(){var t=this;this.status="updating",this.currentUser?fetch("//localhost:8080/current-user").then(function(t){return t.json()}).then(function(e){e.ok?(t.uid=e.uid,t.getUserData().then(function(){t.status="用户名: ".concat(t.uname,", UID: ").concat(t.uid),t.showStatus=!0})):(t.currentUser=!1,t.status="",alert(e.message))}):this.uid.match(/^\d*$/)?(this.error="",this.getUserData().then(function(){t.status="用户名: ".concat(t.uname,", UID: ").concat(t.uid),t.showStatus=!0})):(this.error="UID非法！应为纯数字！（匹配/^\\d*$/）",this.status="")},next:function(){this.showStatus=!1,localStorage.setItem("uid",this.uid),this.$router.push({path:this.$router.path,query:{next:!0}})}}}),q=O,D=(n("c800"),Object(p["a"])(q,U,j,!1,null,"02aa587e",null)),P=D.exports,E=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"download"}},[n("md-card",[n("md-card-header",[n("div",{staticClass:"md-title"},[t._v("下载中！")]),n("div",{staticClass:"md-subhead"},[t._v("该页面正在完善，请至控制台查看完整信息。")])]),n("md-card-content",[n("p",[t._v("目前正在下载：")]),n("p",[t._v(t._s(this.status))])]),n("md-card-expand",[n("md-card-actions",{attrs:{"md-alignment":"right"}},[n("md-card-expand-trigger",[n("md-button",[t._v("详细信息(WIP)")])],1)],1),n("md-card-expand-content",[n("md-card-content",[n("md-progress-bar",{attrs:{"md-mode":"indeterminate"}})],1)],1)],1)],1)],1)},T=[],M={name:"Download",data:function(){return{uid:0,status:""}},mounted:function(){var t=this;if(localStorage.getItem("uid")){this.uid=c()(localStorage.getItem("uid"));var e=new WebSocket("ws://localhost:8080/ws");e.addEventListener("message",function(e){t.status=e.data}),e.addEventListener("open",function(){e.send(t.uid)})}else alert("未检测到UID，将自动跳转回开始！"),localStorage.setItem("step",0),this.$router.push("step-00")}},A=M,F=(n("8b35"),Object(p["a"])(A,E,T,!1,null,"59e6d529",null)),N=F.exports;s["default"].use(v["a"]);var W=new v["a"]({routes:[{path:"/step-00",name:"step-00",component:w,meta:{keepAlive:!0}},{path:"/step-01",name:"step-01",component:$,meta:{keepAlive:!0}},{path:"/step-02",name:"step-02",component:P,meta:{keepAlive:!0}},{path:"/step-03",name:"step-03",component:N,meta:{keepAlive:!1}}]});s["default"].config.productionTip=!1,s["default"].use(i.a),new s["default"]({router:W,render:function(t){return t(m)}}).$mount("#app")},"5c0b":function(t,e,n){"use strict";var s=n("5e27"),a=n.n(s);a.a},"5e27":function(t,e,n){},"7b83":function(t,e,n){"use strict";var s=n("48c6"),a=n.n(s);a.a},"8b35":function(t,e,n){"use strict";var s=n("4b31"),a=n.n(s);a.a},c800:function(t,e,n){"use strict";var s=n("cee8"),a=n.n(s);a.a},cee8:function(t,e,n){}});
//# sourceMappingURL=app.54969e73.js.map